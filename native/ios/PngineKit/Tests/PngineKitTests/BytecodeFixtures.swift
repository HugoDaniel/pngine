/**
 * BytecodeFixtures - Test bytecode data for PngineKit tests
 *
 * Contains base64-encoded PNGB bytecode for various test scenarios.
 */

import Foundation

public enum BytecodeFixtures {

    // MARK: - Simple Instanced Rendering (1315 bytes)
    // 4 triangles at corners, no compute shader
    public static let simpleInstanced = Data(base64Encoded: """
UE5HQgAAAAABAAAAAAAAAAAAAABjAAAAbQAAAB0FAAAgBQAAIgUAAAQAAgEAICggAAABAQEYKCABAAAIAAMzAAAEEMAA//4BAMAA//8SABQAABQBARYDBAAAGTQwAAAyACQxAQAAAAQAbWFpbgUAAAAAABgAAAAYAAAAIAAAADgAAADgAgAAGAMAAGwBAACEBAAAAgAAAJqZGb6amRm+mpkZPpqZGb4AAAAAmpkZPgAAAL8AAAC/AAAAPwAAAL8AAAC/AAAAPwAAAD8AAAA/CnN0cnVjdCBWZXJ0ZXhPdXRwdXQgewogIEBidWlsdGluKHBvc2l0aW9uKSBwb3NpdGlvbiA6IHZlYzRmLAogIEBsb2NhdGlvbigwKSBjb2xvciA6IHZlYzRmLAp9CgpAdmVydGV4CmZuIHZlcnRleE1haW4oCiAgQGxvY2F0aW9uKDApIGFfaW5zdGFuY2VQb3MgOiB2ZWMyZiwKICBAbG9jYXRpb24oMSkgYV92ZXJ0ZXhQb3MgOiB2ZWMyZiwKICBAYnVpbHRpbihpbnN0YW5jZV9pbmRleCkgaW5zdGFuY2VJZHggOiB1MzIKKSAtPiBWZXJ0ZXhPdXRwdXQgewogIHZhciBvdXRwdXQgOiBWZXJ0ZXhPdXRwdXQ7CiAgb3V0cHV0LnBvc2l0aW9uID0gdmVjNGYoYV92ZXJ0ZXhQb3MgKyBhX2luc3RhbmNlUG9zLCAwLjAsIDEuMCk7CgogIC8vIERpZmZlcmVudCBjb2xvciBwZXIgaW5zdGFuY2UKICBsZXQgY29sb3JzID0gYXJyYXk8dmVjNGYsIDQ+KAogICAgdmVjNGYoMS4wLCAwLjAsIDAuMCwgMS4wKSwgIC8vIHJlZAogICAgdmVjNGYoMC4wLCAxLjAsIDAuMCwgMS4wKSwgIC8vIGdyZWVuCiAgICB2ZWM0ZigwLjAsIDAuMCwgMS4wLCAxLjApLCAgLy8gYmx1ZQogICAgdmVjNGYoMS4wLCAxLjAsIDAuMCwgMS4wKSAgIC8vIHllbGxvdwogICk7CiAgb3V0cHV0LmNvbG9yID0gY29sb3JzW2luc3RhbmNlSWR4XTsKICByZXR1cm4gb3V0cHV0Owp9CgpAZnJhZ21lbnQKZm4gZnJhZ01haW4oQGxvY2F0aW9uKDApIGNvbG9yIDogdmVjNGYpIC0+IEBsb2NhdGlvbigwKSB2ZWM0ZiB7CiAgcmV0dXJuIGNvbG9yOwp9CnsidmVydGV4Ijp7InNoYWRlciI6MCwiZW50cnlQb2ludCI6InZlcnRleE1haW4iLCJidWZmZXJzIjpbeyJhcnJheVN0cmlkZSI6OCwic3RlcE1vZGUiOiJpbnN0YW5jZSIsImF0dHJpYnV0ZXMiOlt7InNoYWRlckxvY2F0aW9uIjowLCJvZmZzZXQiOjAsImZvcm1hdCI6ImZsb2F0MzJ4MiJ9XX0seyJhcnJheVN0cmlkZSI6OCwic3RlcE1vZGUiOiJ2ZXJ0ZXgiLCJhdHRyaWJ1dGVzIjpbeyJzaGFkZXJMb2NhdGlvbiI6MSwib2Zmc2V0IjowLCJmb3JtYXQiOiJmbG9hdDMyeDIifV19XX0sImZyYWdtZW50Ijp7InNoYWRlciI6MCwiZW50cnlQb2ludCI6ImZyYWdNYWluIn0sInByaW1pdGl2ZSI6eyJ0b3BvbG9neSI6InRyaWFuZ2xlLWxpc3QifX17fQECAAAAAA==
""", options: .ignoreUnknownCharacters)!

    // MARK: - Instanced with Builtins Only (1481 bytes)
    // Uses builtin indices, no vertex buffers
    public static let instancedBuiltins = Data(base64Encoded: """
UE5HQgAAAAABAAAAAAAAAAAAAABNAAAAVwAAAMMFAADGBQAAyAUAAAQAAAgAATMAAAIQwAD//gEAwAD//xIAFgMEAAAZNDAAADIAJDEBAAAABABtYWluAwAAAAAAxgQAAMYEAACKAAAAUAUAAAIAAAAKc3RydWN0IFZlcnRleE91dHB1dCB7CiAgQGJ1aWx0aW4ocG9zaXRpb24pIHBvc2l0aW9uIDogdmVjNGYsCiAgQGxvY2F0aW9uKDApIGNvbG9yIDogdmVjNGYsCn0KCkB2ZXJ0ZXgKZm4gdmVydGV4TWFpbigKICBAYnVpbHRpbih2ZXJ0ZXhfaW5kZXgpIHZlcnRleElkeCA6IHUzMiwKICBAYnVpbHRpbihpbnN0YW5jZV9pbmRleCkgaW5zdGFuY2VJZHggOiB1MzIKKSAtPiBWZXJ0ZXhPdXRwdXQgewogIC8vIFRyaWFuZ2xlIHZlcnRpY2VzIChoYXJkY29kZWQpCiAgdmFyIHRyaWFuZ2xlVmVydGljZXMgPSBhcnJheTx2ZWMyZiwgMz4oCiAgICB2ZWMyZigtMC4xNSwgLTAuMTUpLAogICAgdmVjMmYoMC4xNSwgLTAuMTUpLAogICAgdmVjMmYoMC4wLCAwLjE1KQogICk7CgogIC8vIEluc3RhbmNlIHBvc2l0aW9ucyAoaGFyZGNvZGVkKQogIHZhciBpbnN0YW5jZVBvc2l0aW9ucyA9IGFycmF5PHZlYzJmLCA0PigKICAgIHZlYzJmKC0wLjUsIC0wLjUpLCAgLy8gaW5zdGFuY2UgMDogYm90dG9tLWxlZnQKICAgIHZlYzJmKDAuNSwgLTAuNSksICAgLy8gaW5zdGFuY2UgMTogYm90dG9tLXJpZ2h0CiAgICB2ZWMyZigtMC41LCAwLjUpLCAgIC8vIGluc3RhbmNlIDI6IHRvcC1sZWZ0CiAgICB2ZWMyZigwLjUsIDAuNSkgICAgIC8vIGluc3RhbmNlIDM6IHRvcC1yaWdodAogICk7CgogIGxldCB2ZXJ0ZXggPSB0cmlhbmdsZVZlcnRpY2VzW3ZlcnRleElkeF07CiAgbGV0IG9mZnNldCA9IGluc3RhbmNlUG9zaXRpb25zW2luc3RhbmNlSWR4XTsKCiAgdmFyIG91dHB1dCA6IFZlcnRleE91dHB1dDsKICBvdXRwdXQucG9zaXRpb24gPSB2ZWM0Zih2ZXJ0ZXggKyBvZmZzZXQsIDAuMCwgMS4wKTsKCiAgLy8gRGlmZmVyZW50IGNvbG9yIHBlciBpbnN0YW5jZQogIHZhciBjb2xvcnMgPSBhcnJheTx2ZWM0ZiwgND4oCiAgICB2ZWM0ZigxLjAsIDAuMCwgMC4wLCAxLjApLCAgLy8gcmVkCiAgICB2ZWM0ZigwLjAsIDEuMCwgMC4wLCAxLjApLCAgLy8gZ3JlZW4KICAgIHZlYzRmKDAuMCwgMC4wLCAxLjAsIDEuMCksICAvLyBibHVlCiAgICB2ZWM0ZigxLjAsIDEuMCwgMC4wLCAxLjApICAgLy8geWVsbG93CiAgKTsKICBvdXRwdXQuY29sb3IgPSBjb2xvcnNbaW5zdGFuY2VJZHhdOwogIHJldHVybiBvdXRwdXQ7Cn0KCkBmcmFnbWVudApmbiBmcmFnTWFpbihAbG9jYXRpb24oMCkgY29sb3IgOiB2ZWM0ZikgLT4gQGxvY2F0aW9uKDApIHZlYzRmIHsKICByZXR1cm4gY29sb3I7Cn0KeyJ2ZXJ0ZXgiOnsic2hhZGVyIjowLCJlbnRyeVBvaW50IjoidmVydGV4TWFpbiJ9LCJmcmFnbWVudCI6eyJzaGFkZXIiOjAsImVudHJ5UG9pbnQiOiJmcmFnTWFpbiJ9LCJwcmltaXRpdmUiOnsidG9wb2xvZ3kiOiJ0cmlhbmdsZS1saXN0In19e30BAAAAAAA=
""", options: .ignoreUnknownCharacters)!

    // MARK: - Boids with Compute Init (1820 bytes)
    // 64 particles with compute shader initialization
    public static let boidsCompute = Data(base64Encoded: """
UE5HQgAAAAABAAAAAAAAAAAAAAB8AAAAhwAAABQHAAAZBwAAGwcAAAQAAQQBAgEAGCggAAAAAQGEAKAIAAMJAQQKAAEFMwABBhESARMAABgBAQEZNDMBAAcQwAD//gEAwAD//xIAFAABFAEAFgNAAAAZNDAAADUAMgEkMQEAAAAFAGJvaWRzCAAAAAAAGAAAABgAAAAjAgAAOwIAACoCAABlBAAAogEAAAcGAAAsAAAAMwYAABQAAABHBgAAAgAAAEkGAAACAAAAzczMvc3MzL3NzMw9zczMvQAAAADNzMw9CnN0cnVjdCBQYXJ0aWNsZSB7CiAgcG9zIDogdmVjMmYsCiAgdmVsIDogdmVjMmYsCn0KCnN0cnVjdCBQYXJ0aWNsZXMgewogIHBhcnRpY2xlcyA6IGFycmF5PFBhcnRpY2xlPiwKfQoKQGJpbmRpbmcoMCkgQGdyb3VwKDApIHZhcjxzdG9yYWdlLCByZWFkX3dyaXRlPiBkYXRhIDogUGFydGljbGVzOwoKQGNvbXB1dGUgQHdvcmtncm91cF9zaXplKDY0KQpmbiBtYWluKEBidWlsdGluKGdsb2JhbF9pbnZvY2F0aW9uX2lkKSBpZCA6IHZlYzN1KSB7CiAgbGV0IGkgPSBpZC54OwogIC8vIEhBUkQtQ09ERUQgbGltaXQgaW5zdGVhZCBvZiBhcnJheUxlbmd0aAogIGlmIChpID49IDY0dSkgeyByZXR1cm47IH0KCiAgbGV0IHQgPSBmMzIoaSkgLyA2NC4wOwogIGxldCBhbmdsZSA9IHQgKiA2LjI4MzE4NTsKICBsZXQgcmFkaXVzID0gMC4zICsgdCAqIDAuNTsKCiAgZGF0YS5wYXJ0aWNsZXNbaV0ucG9zID0gdmVjMmYoY29zKGFuZ2xlKSAqIHJhZGl1cywgc2luKGFuZ2xlKSAqIHJhZGl1cyk7CiAgZGF0YS5wYXJ0aWNsZXNbaV0udmVsID0gdmVjMmYoMC4wLCAwLjApOwp9CgpzdHJ1Y3QgVmVydGV4T3V0cHV0IHsKICBAYnVpbHRpbihwb3NpdGlvbikgcG9zaXRpb24gOiB2ZWM0ZiwKICBAbG9jYXRpb24oMCkgY29sb3IgOiB2ZWM0ZiwKfQoKQHZlcnRleApmbiB2ZXJ0ZXhNYWluKAogIEBsb2NhdGlvbigwKSBhX3BhcnRpY2xlUG9zIDogdmVjMmYsCiAgQGxvY2F0aW9uKDEpIGFfcGFydGljbGVWZWwgOiB2ZWMyZiwKICBAbG9jYXRpb24oMikgYV9wb3MgOiB2ZWMyZgopIC0+IFZlcnRleE91dHB1dCB7CiAgdmFyIG91dHB1dCA6IFZlcnRleE91dHB1dDsKICBvdXRwdXQucG9zaXRpb24gPSB2ZWM0KGFfcG9zICsgYV9wYXJ0aWNsZVBvcywgMC4wLCAxLjApOwogIG91dHB1dC5jb2xvciA9IHZlYzQoCiAgICBhX3BhcnRpY2xlUG9zLnggKiAwLjUgKyAwLjUsCiAgICBhX3BhcnRpY2xlUG9zLnkgKiAwLjUgKyAwLjUsCiAgICAwLjUsCiAgICAxLjAKICApOwogIHJldHVybiBvdXRwdXQ7Cn0KCkBmcmFnbWVudApmbiBmcmFnTWFpbihAbG9jYXRpb24oMCkgY29sb3IgOiB2ZWM0ZikgLT4gQGxvY2F0aW9uKDApIHZlYzRmIHsKICByZXR1cm4gY29sb3I7Cn0KeyJ2ZXJ0ZXgiOnsic2hhZGVyIjoxLCJlbnRyeVBvaW50IjoidmVydGV4TWFpbiIsImJ1ZmZlcnMiOlt7ImFycmF5U3RyaWRlIjoxNiwic3RlcE1vZGUiOiJpbnN0YW5jZSIsImF0dHJpYnV0ZXMiOlt7InNoYWRlckxvY2F0aW9uIjowLCJvZmZzZXQiOjAsImZvcm1hdCI6ImZsb2F0MzJ4MiJ9LHsic2hhZGVyTG9jYXRpb24iOjEsIm9mZnNldCI6OCwiZm9ybWF0IjoiZmxvYXQzMngyIn1dfSx7ImFycmF5U3RyaWRlIjo4LCJzdGVwTW9kZSI6InZlcnRleCIsImF0dHJpYnV0ZXMiOlt7InNoYWRlckxvY2F0aW9uIjoyLCJvZmZzZXQiOjAsImZvcm1hdCI6ImZsb2F0MzJ4MiJ9XX1dfSwiZnJhZ21lbnQiOnsic2hhZGVyIjoxLCJlbnRyeVBvaW50IjoiZnJhZ01haW4ifSwicHJpbWl0aXZlIjp7InRvcG9sb2d5IjoidHJpYW5nbGUtbGlzdCJ9fXsiY29tcHV0ZSI6eyJzaGFkZXIiOjAsImVudHJ5UG9pbnQiOiJtYWluIn19AwIBBwACAwEAAAEAAAAAAAAAAAB7fXt9AgEAAgAAAAA=
""", options: .ignoreUnknownCharacters)!

    // MARK: - Invalid Bytecode (for error testing)

    /// Empty data - should fail validation
    public static let empty = Data()

    /// Too short to contain header
    public static let tooShort = Data([0x50, 0x4E, 0x47, 0x42])

    /// Wrong magic bytes
    public static let wrongMagic = Data([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                         0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00])

    /// Valid header but truncated content
    public static let truncated: Data = {
        // Start with valid bytecode but truncate it
        let valid = simpleInstanced
        return valid.prefix(50)
    }()

    // MARK: - Metadata

    /// Expected sizes for validation
    public static let expectedSizes: [String: Int] = [
        "simpleInstanced": 1315,
        "instancedBuiltins": 1481,
        "boidsCompute": 1820
    ]
}
