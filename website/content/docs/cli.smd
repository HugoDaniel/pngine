---
.title = "CLI Reference",
.description = "Command-line interface",
.author = "PNGine Team",
.date = @date("2024-12-30"),
.layout = "docs.shtml",
---

## Installation

```bash
npm install pngine
```

Or build from source:

```bash
git clone https://github.com/pngine/pngine
cd pngine
zig build
```

## Synopsis

```
pngine [command] <input> [options]
```

## Commands

### Default (render)

Compile source to PNG with embedded bytecode.

```bash
pngine <input.pngine> [-o output.png] [options]
```

By default, creates a 1x1 transparent PNG with bytecode in the `pNGb` chunk.

### compile

Compile source to raw bytecode.

```bash
pngine compile <input.pngine> [-o output.pngb]
```

### check

Validate bytecode and optionally trace GPU commands.

```bash
pngine check <input> [--verbose]
```

Accepts `.pngine`, `.pngb`, or `.png` files.

**Output:**
```
Valid PNGB bytecode
  Version: 0
  Plugins: render
  Shaders: 2
  Frames: 1
  Size: 1,247 bytes
```

With `--verbose`, prints full GPU call trace:

```
Valid PNGB bytecode
  Version: 0
  Plugins: render compute
  Shaders: 3
  Frames: 1
  Size: 4,821 bytes

GPU Call Trace:
  createShaderModule(id=0, codeLen=892)
  createShaderModule(id=1, codeLen=456)
  createBuffer(id=0, size=32768, usage=VERTEX|STORAGE)
  createBuffer(id=1, size=16, usage=UNIFORM|COPY_DST)
  createComputePipeline(id=0, shader=1)
  createRenderPipeline(id=0, shader=0)
  createBindGroup(id=0, layout=auto)
  defineFrame(id=0, name="main")
    execPass(id=0)  // compute
    execPass(id=1)  // render
  endFrame
```

### embed

Embed bytecode into an existing PNG.

```bash
pngine embed <image.png> <bytecode.pngb> [-o output.png]
```

### extract

Extract bytecode from PNG.

```bash
pngine extract <image.png> [-o output.pngb]
```

## Options

### Output

| Option | Description |
|--------|-------------|
| `-o, --output <path>` | Output file path. Default: input name with appropriate extension |

### Rendering

| Option | Description |
|--------|-------------|
| `-f, --frame` | Render actual frame via GPU (requires GPU backend) |
| `-s, --size <WxH>` | Output dimensions when rendering. Default: `512x512` |
| `-t, --time <seconds>` | Time value for animation. Default: `0.0` |

### Embedding

| Option | Description |
|--------|-------------|
| `-e, --embed` | Embed bytecode in output PNG (default: on) |
| `--no-embed` | Don't embed bytecode |

### Validation

| Option | Description |
|--------|-------------|
| `-v, --verbose` | Print full GPU call trace (check command) |

## Examples

### Basic Compilation

```bash
# Compile and embed in 1x1 PNG
pngine shader.pngine

# Compile with custom output path
pngine shader.pngine -o build/shader.png

# Compile to raw bytecode only
pngine compile shader.pngine -o shader.pngb
```

### GPU Rendering

```bash
# Render 512x512 frame with embedded bytecode
pngine shader.pngine --frame

# Render at specific size
pngine shader.pngine --frame -s 1920x1080

# Render animation at t=2.5 seconds
pngine shader.pngine --frame -t 2.5

# Render without embedding bytecode
pngine shader.pngine --frame --no-embed
```

### Validation

```bash
# Validate bytecode
pngine check shader.pngb
pngine check output.png
pngine check shader.pngine

# Validate with GPU call trace
pngine check shader.pngine --verbose
```

### PNG Manipulation

```bash
# Embed bytecode into existing artwork
pngine embed artwork.png shader.pngb -o final.png

# Extract bytecode from PNG
pngine extract final.png -o extracted.pngb
```

## Input Formats

| Extension | Description |
|-----------|-------------|
| `.pngine` | DSL source (macro-based syntax) |
| `.pbsf` | Legacy PBSF source (S-expressions) |
| `.pngb` | Compiled bytecode |
| `.png` | PNG with embedded bytecode |

## Exit Codes

| Code | Description |
|------|-------------|
| 0 | Success |
| 1 | Invalid arguments |
| 2 | File not found |
| 3 | Parse error |
| 4 | Compilation error |
| 5 | I/O error |

## Environment

The CLI reads no environment variables. All configuration is via command-line arguments.

## NPM Integration

When installed via npm, use `npx`:

```bash
npx pngine shader.pngine -o shader.png
npx pngine check shader.png --verbose
```

Or add to package.json scripts:

```json
{
  "scripts": {
    "build:shader": "pngine src/shader.pngine -o dist/shader.png",
    "build:preview": "pngine src/shader.pngine --frame -o preview.png"
  }
}
```

## Related

- [Getting Started](/docs/getting-started/) - First program tutorial
- [DSL Syntax](/docs/dsl-syntax/) - Language overview
- [Bytecode Format](/docs/bytecode/) - PNGB specification
